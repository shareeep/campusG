generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Escrow {
  id            String       @id @default(uuid())
  orderId       String       @unique
  custId        String
  runnerId      String?      // Null until a runner accepts the order
  amount        Decimal      @db.Decimal(10, 2)  // Total amount (food + delivery)
  foodFee       Decimal      @db.Decimal(10, 2)  // Amount for food
  deliveryFee   Decimal      @db.Decimal(10, 2)  // Amount for delivery
  escrowStatus  EscrowStatus @default(PENDING)
  releaseTime   DateTime?    // When the funds are released from escrow
  holdTime      DateTime     @default(now())
  timeoutTime   DateTime?    // When the escrow times out
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
}

enum EscrowStatus {
  PENDING      // Funds are pending being held in escrow
  HELD         // Funds are held in escrow
  RELEASED     // Funds have been released to the runner
  REFUNDED     // Funds have been refunded to the customer
  FAILED       // Escrow operation failed
}
