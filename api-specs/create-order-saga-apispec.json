{"definitions":{},"info":{"description":"powered by Flasgger","termsOfService":"/tos","title":"A swagger API","version":"0.0.1"},"paths":{"/health":{"get":{"responses":{"200":{"description":"Service is healthy.","schema":{"properties":{"status":{"example":"healthy","type":"string"}},"type":"object"}}},"summary":"Health check for the Create Order Saga Orchestrator API.","tags":["Health"]}},"/orders":{"post":{"consumes":["application/json"],"description":"Initiates the asynchronous Create Order Saga workflow by sending the initial command.","parameters":[{"in":"body","name":"body","required":true,"schema":{"properties":{"customer_id":{"example":"cust_123","type":"string"},"order_details":{"properties":{"deliveryFee":{"description":"Delivery fee calculated by frontend/caller","format":"float","type":"number"},"deliveryLocation":{"type":"string"},"foodItems":{"items":{"properties":{"name":{"type":"string"},"price":{"format":"float","type":"number"},"quantity":{"type":"integer"}},"type":"object"},"type":"array"},"storeLocation":{"nullable":true,"type":"string"}},"type":"object"}},"required":["customer_id","order_details"],"type":"object"}}],"produces":["application/json"],"responses":{"202":{"description":"Saga started successfully.","schema":{"properties":{"message":{"type":"string"},"saga_id":{"format":"uuid","type":"string"},"status":{"example":"STARTED","type":"string"},"success":{"example":true,"type":"boolean"}},"type":"object"}},"400":{"description":"Bad Request (e.g., missing fields, error calculating total, Kafka unavailable)"},"500":{"description":"Internal Server Error (e.g., orchestrator not initialized, unexpected error)"}},"summary":"Start the Create Order Saga.","tags":["Saga"]}},"/sagas":{"get":{"description":"Retrieves a list of the 100 most recent saga instances, optionally filtered by status.","parameters":[{"description":"Filter sagas by status.","enum":["STARTED","COMPLETED","FAILED","COMPENSATING","COMPENSATED","CANCELLING","CANCELLED"],"in":"query","name":"status","required":false,"type":"string"}],"responses":{"200":{"description":"List of sagas retrieved.","schema":{"items":{"properties":{"created_at":{"format":"date-time","type":"string"},"current_step":{"enum":["GET_USER_DATA","CREATE_ORDER","AUTHORIZE_PAYMENT","HOLD_FUNDS","UPDATE_ORDER_STATUS","START_TIMER","NOTIFY_USER"],"nullable":true,"type":"string"},"customer_id":{"type":"string"},"id":{"format":"uuid","type":"string"},"order_id":{"format":"uuid","nullable":true,"type":"string"},"status":{"enum":["STARTED","COMPLETED","FAILED","COMPENSATING","COMPENSATED","CANCELLING","CANCELLED"],"type":"string"},"updated_at":{"format":"date-time","type":"string"}},"type":"object"},"type":"array"}},"400":{"description":"Invalid status value provided."}},"summary":"List recent saga instances.","tags":["Saga"]}},"/sagas/{saga_id}":{"get":{"parameters":[{"description":"The ID of the saga instance.","format":"uuid","in":"path","name":"saga_id","required":true,"type":"string"}],"responses":{"200":{"description":"Saga state retrieved.","schema":{"properties":{"completed_at":{"format":"date-time","nullable":true,"type":"string"},"created_at":{"format":"date-time","type":"string"},"current_step":{"enum":["GET_USER_DATA","CREATE_ORDER","AUTHORIZE_PAYMENT","HOLD_FUNDS","UPDATE_ORDER_STATUS","START_TIMER","NOTIFY_USER"],"nullable":true,"type":"string"},"customer_id":{"type":"string"},"error":{"nullable":true,"type":"string"},"id":{"format":"uuid","type":"string"},"order_id":{"format":"uuid","nullable":true,"type":"string"},"status":{"enum":["STARTED","COMPLETED","FAILED","COMPENSATING","COMPENSATED","CANCELLING","CANCELLED"],"type":"string"},"updated_at":{"format":"date-time","type":"string"}},"type":"object"}},"404":{"description":"Saga not found."}},"summary":"Get the current state of a specific saga instance.","tags":["Saga"]}},"/sagas/{saga_id}/cancel":{"post":{"description":"Attempts to initiate the cancellation/compensation process for a specific saga instance. Only allowed if the saga is in a state where cancellation is potentially meaningful (e.g., STARTED, COMPENSATING, COMPLETED).","parameters":[{"description":"The ID of the saga instance to cancel.","format":"uuid","in":"path","name":"saga_id","required":true,"type":"string"}],"responses":{"202":{"description":"Saga cancellation initiated successfully.","schema":{"properties":{"message":{"type":"string"}},"type":"object"}},"404":{"description":"Saga not found."},"409":{"description":"Conflict - Saga cannot be cancelled in its current state."},"500":{"description":"Internal Server Error (failed to initiate cancellation)."},"503":{"description":"Service unavailable (orchestrator not initialized)."}},"summary":"Manually request cancellation of a saga.","tags":["Saga"]}}},"swagger":"2.0"}
